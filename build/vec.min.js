!function(t){"object"==typeof exports?module.exports=t():"function"==typeof define&&define.amd?define(t):"undefined"!=typeof window?window.vecmath=t():"undefined"!=typeof global?global.vecmath=t():"undefined"!=typeof self&&(self.vecmath=t())}(function(){var t,i,s;return function n(t,i,s){function h(e,a){if(!i[e]){if(!t[e]){var u=typeof require=="function"&&require;if(!a&&u)return u(e,!0);if(r)return r(e,!0);throw new Error("Cannot find module '"+e+"'")}var o=i[e]={exports:{}};t[e][0].call(o.exports,function(i){var s=t[e][1][i];return h(s?s:i)},o,o.exports,n,t,i,s)}return i[e].exports}var r=typeof require=="function"&&require;for(var e=0;e<s.length;e++)h(s[e]);return h}({1:[function(t,i,s){var n=typeof Float32Array!=="undefined"?Float32Array:Array;function h(t){this.val=new n(9);if(t){this.copy(t)}else{this.idt()}}var r=h.prototype;r.clone=function(){return new h(this)};r.copy=function(t){var i=this.val,s=t.val;i[0]=s[0];i[1]=s[1];i[2]=s[2];i[3]=s[3];i[4]=s[4];i[5]=s[5];i[6]=s[6];i[7]=s[7];i[8]=s[8];return this};r.fromMat4=function(t){var i=t.val,s=this.val;s[0]=i[0];s[1]=i[1];s[2]=i[2];s[3]=i[4];s[4]=i[5];s[5]=i[6];s[6]=i[8];s[7]=i[9];s[8]=i[10];return this};r.fromArray=function(t){var i=this.val;i[0]=t[0];i[1]=t[1];i[2]=t[2];i[3]=t[3];i[4]=t[4];i[5]=t[5];i[6]=t[6];i[7]=t[7];i[8]=t[8];return this};r.identity=function(){var t=this.val;t[0]=1;t[1]=0;t[2]=0;t[3]=0;t[4]=1;t[5]=0;t[6]=0;t[7]=0;t[8]=1;return this};r.transpose=function(){var t=this.val,i=t[1],s=t[2],n=t[5];t[1]=t[3];t[2]=t[6];t[3]=i;t[5]=t[7];t[6]=s;t[7]=n;return this};r.invert=function(){var t=this.val,i=t[0],s=t[1],n=t[2],h=t[3],r=t[4],e=t[5],a=t[6],u=t[7],o=t[8],y=o*r-e*u,c=-o*h+e*a,f=u*h-r*a,x=i*y+s*c+n*f;if(!x){return null}x=1/x;t[0]=y*x;t[1]=(-o*s+n*u)*x;t[2]=(e*s-n*r)*x;t[3]=c*x;t[4]=(o*i-n*a)*x;t[5]=(-e*i+n*h)*x;t[6]=f*x;t[7]=(-u*i+s*a)*x;t[8]=(r*i-s*h)*x;return this};r.adjoint=function(){var t=this.val,i=t[0],s=t[1],n=t[2],h=t[3],r=t[4],e=t[5],a=t[6],u=t[7],o=t[8];t[0]=r*o-e*u;t[1]=n*u-s*o;t[2]=s*e-n*r;t[3]=e*a-h*o;t[4]=i*o-n*a;t[5]=n*h-i*e;t[6]=h*u-r*a;t[7]=s*a-i*u;t[8]=i*r-s*h;return this};r.determinant=function(){var t=this.val,i=t[0],s=t[1],n=t[2],h=t[3],r=t[4],e=t[5],a=t[6],u=t[7],o=t[8];return i*(o*r-e*u)+s*(-o*h+e*a)+n*(u*h-r*a)};r.multiply=function(t){var i=this.val,s=t.val,n=i[0],h=i[1],r=i[2],e=i[3],a=i[4],u=i[5],o=i[6],y=i[7],c=i[8],f=s[0],x=s[1],v=s[2],l=s[3],z=s[4],d=s[5],w=s[6],M=s[7],p=s[8];i[0]=f*n+x*e+v*o;i[1]=f*h+x*a+v*y;i[2]=f*r+x*u+v*c;i[3]=l*n+z*e+d*o;i[4]=l*h+z*a+d*y;i[5]=l*r+z*u+d*c;i[6]=w*n+M*e+p*o;i[7]=w*h+M*a+p*y;i[8]=w*r+M*u+p*c;return this};r.translate=function(t){var i=this.val,s=t.x,n=t.y;i[6]=s*i[0]+n*i[3]+i[6];i[7]=s*i[1]+n*i[4]+i[7];i[8]=s*i[2]+n*i[5]+i[8];return this};r.rotate=function(t){var i=this.val,s=i[0],n=i[1],h=i[2],r=i[3],e=i[4],a=i[5],u=Math.sin(t),o=Math.cos(t);i[0]=o*s+u*r;i[1]=o*n+u*e;i[2]=o*h+u*a;i[3]=o*r-u*s;i[4]=o*e-u*n;i[5]=o*a-u*h;return this};r.scale=function(t){var i=this.val,s=t.x,n=t.y;i[0]=s*i[0];i[1]=s*i[1];i[2]=s*i[2];i[3]=n*i[3];i[4]=n*i[4];i[5]=n*i[5];return this};r.fromQuat=function(t){var i=t.x,s=t.y,n=t.z,h=t.w,r=i+i,e=s+s,a=n+n,u=i*r,o=i*e,y=i*a,c=s*e,f=s*a,x=n*a,v=h*r,l=h*e,z=h*a,d=this.val;d[0]=1-(c+x);d[3]=o+z;d[6]=y-l;d[1]=o-z;d[4]=1-(u+x);d[7]=f+v;d[2]=y+l;d[5]=f-v;d[8]=1-(u+c);return this};r.normalFromMat4=function(t){var i=t.val,s=this.val,n=i[0],h=i[1],r=i[2],e=i[3],a=i[4],u=i[5],o=i[6],y=i[7],c=i[8],f=i[9],x=i[10],v=i[11],l=i[12],z=i[13],d=i[14],w=i[15],M=n*u-h*a,p=n*o-r*a,m=n*y-e*a,q=h*o-r*u,g=h*y-e*u,S=r*y-e*o,b=c*z-f*l,A=c*d-x*l,V=c*w-v*l,j=f*d-x*z,Q=f*w-v*z,F=x*w-v*d,I=M*F-p*Q+m*j+q*V-g*A+S*b;if(!I){return null}I=1/I;s[0]=(u*F-o*Q+y*j)*I;s[1]=(o*V-a*F-y*A)*I;s[2]=(a*Q-u*V+y*b)*I;s[3]=(r*Q-h*F-e*j)*I;s[4]=(n*F-r*V+e*A)*I;s[5]=(h*V-n*Q-e*b)*I;s[6]=(z*S-d*g+w*q)*I;s[7]=(d*m-l*S-w*p)*I;s[8]=(l*g-z*m+w*M)*I;return this};r.mul=r.multiply;r.idt=r.identity;r.reset=r.idt;r.toString=function(){var t=this.val;return"Matrix3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"};i.exports=h},{}],2:[function(t,i,s){var n=typeof Float32Array!=="undefined"?Float32Array:Array;var h=1e-6;function r(t){this.val=new n(16);if(t){this.copy(t)}else{this.idt()}}var e=r.prototype;e.clone=function(){return new r(this)};e.copy=function(t){var i=this.val,s=t.val;i[0]=s[0];i[1]=s[1];i[2]=s[2];i[3]=s[3];i[4]=s[4];i[5]=s[5];i[6]=s[6];i[7]=s[7];i[8]=s[8];i[9]=s[9];i[10]=s[10];i[11]=s[11];i[12]=s[12];i[13]=s[13];i[14]=s[14];i[15]=s[15];return this};e.fromArray=function(t){var i=this.val;i[0]=t[0];i[1]=t[1];i[2]=t[2];i[3]=t[3];i[4]=t[4];i[5]=t[5];i[6]=t[6];i[7]=t[7];i[8]=t[8];i[9]=t[9];i[10]=t[10];i[11]=t[11];i[12]=t[12];i[13]=t[13];i[14]=t[14];i[15]=t[15];return this};e.identity=function(){var t=this.val;t[0]=1;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=1;t[6]=0;t[7]=0;t[8]=0;t[9]=0;t[10]=1;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return this};e.transpose=function(){var t=this.val,i=t[1],s=t[2],n=t[3],h=t[6],r=t[7],e=t[11];t[1]=t[4];t[2]=t[8];t[3]=t[12];t[4]=i;t[6]=t[9];t[7]=t[13];t[8]=s;t[9]=h;t[11]=t[14];t[12]=n;t[13]=r;t[14]=e;return this};e.invert=function(){var t=this.val,i=t[0],s=t[1],n=t[2],h=t[3],r=t[4],e=t[5],a=t[6],u=t[7],o=t[8],y=t[9],c=t[10],f=t[11],x=t[12],v=t[13],l=t[14],z=t[15],d=i*e-s*r,w=i*a-n*r,M=i*u-h*r,p=s*a-n*e,m=s*u-h*e,q=n*u-h*a,g=o*v-y*x,S=o*l-c*x,b=o*z-f*x,A=y*l-c*v,V=y*z-f*v,j=c*z-f*l,Q=d*j-w*V+M*A+p*b-m*S+q*g;if(!Q){return null}Q=1/Q;t[0]=(e*j-a*V+u*A)*Q;t[1]=(n*V-s*j-h*A)*Q;t[2]=(v*q-l*m+z*p)*Q;t[3]=(c*m-y*q-f*p)*Q;t[4]=(a*b-r*j-u*S)*Q;t[5]=(i*j-n*b+h*S)*Q;t[6]=(l*M-x*q-z*w)*Q;t[7]=(o*q-c*M+f*w)*Q;t[8]=(r*V-e*b+u*g)*Q;t[9]=(s*b-i*V-h*g)*Q;t[10]=(x*m-v*M+z*d)*Q;t[11]=(y*M-o*m-f*d)*Q;t[12]=(e*S-r*A-a*g)*Q;t[13]=(i*A-s*S+n*g)*Q;t[14]=(v*w-x*p-l*d)*Q;t[15]=(o*p-y*w+c*d)*Q;return this};e.adjoint=function(){var t=this.val,i=t[0],s=t[1],n=t[2],h=t[3],r=t[4],e=t[5],a=t[6],u=t[7],o=t[8],y=t[9],c=t[10],f=t[11],x=t[12],v=t[13],l=t[14],z=t[15];t[0]=e*(c*z-f*l)-y*(a*z-u*l)+v*(a*f-u*c);t[1]=-(s*(c*z-f*l)-y*(n*z-h*l)+v*(n*f-h*c));t[2]=s*(a*z-u*l)-e*(n*z-h*l)+v*(n*u-h*a);t[3]=-(s*(a*f-u*c)-e*(n*f-h*c)+y*(n*u-h*a));t[4]=-(r*(c*z-f*l)-o*(a*z-u*l)+x*(a*f-u*c));t[5]=i*(c*z-f*l)-o*(n*z-h*l)+x*(n*f-h*c);t[6]=-(i*(a*z-u*l)-r*(n*z-h*l)+x*(n*u-h*a));t[7]=i*(a*f-u*c)-r*(n*f-h*c)+o*(n*u-h*a);t[8]=r*(y*z-f*v)-o*(e*z-u*v)+x*(e*f-u*y);t[9]=-(i*(y*z-f*v)-o*(s*z-h*v)+x*(s*f-h*y));t[10]=i*(e*z-u*v)-r*(s*z-h*v)+x*(s*u-h*e);t[11]=-(i*(e*f-u*y)-r*(s*f-h*y)+o*(s*u-h*e));t[12]=-(r*(y*l-c*v)-o*(e*l-a*v)+x*(e*c-a*y));t[13]=i*(y*l-c*v)-o*(s*l-n*v)+x*(s*c-n*y);t[14]=-(i*(e*l-a*v)-r*(s*l-n*v)+x*(s*a-n*e));t[15]=i*(e*c-a*y)-r*(s*c-n*y)+o*(s*a-n*e);return this};e.determinant=function(){var t=this.val,i=t[0],s=t[1],n=t[2],h=t[3],r=t[4],e=t[5],a=t[6],u=t[7],o=t[8],y=t[9],c=t[10],f=t[11],x=t[12],v=t[13],l=t[14],z=t[15],d=i*e-s*r,w=i*a-n*r,M=i*u-h*r,p=s*a-n*e,m=s*u-h*e,q=n*u-h*a,g=o*v-y*x,S=o*l-c*x,b=o*z-f*x,A=y*l-c*v,V=y*z-f*v,j=c*z-f*l;return d*j-w*V+M*A+p*b-m*S+q*g};e.multiply=function(t){var i=this.val,s=t.val,n=i[0],h=i[1],r=i[2],e=i[3],a=i[4],u=i[5],o=i[6],y=i[7],c=i[8],f=i[9],x=i[10],v=i[11],l=i[12],z=i[13],d=i[14],w=i[15];var M=s[0],p=s[1],m=s[2],q=s[3];i[0]=M*n+p*a+m*c+q*l;i[1]=M*h+p*u+m*f+q*z;i[2]=M*r+p*o+m*x+q*d;i[3]=M*e+p*y+m*v+q*w;M=s[4];p=s[5];m=s[6];q=s[7];i[4]=M*n+p*a+m*c+q*l;i[5]=M*h+p*u+m*f+q*z;i[6]=M*r+p*o+m*x+q*d;i[7]=M*e+p*y+m*v+q*w;M=s[8];p=s[9];m=s[10];q=s[11];i[8]=M*n+p*a+m*c+q*l;i[9]=M*h+p*u+m*f+q*z;i[10]=M*r+p*o+m*x+q*d;i[11]=M*e+p*y+m*v+q*w;M=s[12];p=s[13];m=s[14];q=s[15];i[12]=M*n+p*a+m*c+q*l;i[13]=M*h+p*u+m*f+q*z;i[14]=M*r+p*o+m*x+q*d;i[15]=M*e+p*y+m*v+q*w;return this};e.translate=function(t){var i=t.x,s=t.y,n=t.z,h=this.val;h[12]=h[0]*i+h[4]*s+h[8]*n+h[12];h[13]=h[1]*i+h[5]*s+h[9]*n+h[13];h[14]=h[2]*i+h[6]*s+h[10]*n+h[14];h[15]=h[3]*i+h[7]*s+h[11]*n+h[15];return this};e.scale=function(t){var i=t.x,s=t.y,n=t.z,h=this.val;h[0]=h[0]*i;h[1]=h[1]*i;h[2]=h[2]*i;h[3]=h[3]*i;h[4]=h[4]*s;h[5]=h[5]*s;h[6]=h[6]*s;h[7]=h[7]*s;h[8]=h[8]*n;h[9]=h[9]*n;h[10]=h[10]*n;h[11]=h[11]*n;h[12]=h[12];h[13]=h[13];h[14]=h[14];h[15]=h[15];return this};e.rotate=function(t,i){var s=this.val,n=i.x,r=i.y,e=i.z,a=Math.sqrt(n*n+r*r+e*e),u,o,y,c,f,x,v,l,z,d,w,M,p,m,q,g,S,b,A,V,j,Q,F,I;if(Math.abs(a)<h){return null}a=1/a;n*=a;r*=a;e*=a;u=Math.sin(t);o=Math.cos(t);y=1-o;c=s[0];f=s[1];x=s[2];v=s[3];l=s[4];z=s[5];d=s[6];w=s[7];M=s[8];p=s[9];m=s[10];q=s[11];g=n*n*y+o;S=r*n*y+e*u;b=e*n*y-r*u;A=n*r*y-e*u;V=r*r*y+o;j=e*r*y+n*u;Q=n*e*y+r*u;F=r*e*y-n*u;I=e*e*y+o;s[0]=c*g+l*S+M*b;s[1]=f*g+z*S+p*b;s[2]=x*g+d*S+m*b;s[3]=v*g+w*S+q*b;s[4]=c*A+l*V+M*j;s[5]=f*A+z*V+p*j;s[6]=x*A+d*V+m*j;s[7]=v*A+w*V+q*j;s[8]=c*Q+l*F+M*I;s[9]=f*Q+z*F+p*I;s[10]=x*Q+d*F+m*I;s[11]=v*Q+w*F+q*I;return this};e.rotateX=function(t){var i=this.val,s=Math.sin(t),n=Math.cos(t),h=i[4],r=i[5],e=i[6],a=i[7],u=i[8],o=i[9],y=i[10],c=i[11];i[4]=h*n+u*s;i[5]=r*n+o*s;i[6]=e*n+y*s;i[7]=a*n+c*s;i[8]=u*n-h*s;i[9]=o*n-r*s;i[10]=y*n-e*s;i[11]=c*n-a*s;return this};e.rotateY=function(t){var i=this.val,s=Math.sin(t),n=Math.cos(t),h=i[0],r=i[1],e=i[2],a=i[3],u=i[8],o=i[9],y=i[10],c=i[11];i[0]=h*n-u*s;i[1]=r*n-o*s;i[2]=e*n-y*s;i[3]=a*n-c*s;i[8]=h*s+u*n;i[9]=r*s+o*n;i[10]=e*s+y*n;i[11]=a*s+c*n;return this};e.rotateZ=function(t){var i=this.val,s=Math.sin(t),n=Math.cos(t),h=i[0],r=i[1],e=i[2],a=i[3],u=i[4],o=i[5],y=i[6],c=i[7];i[0]=h*n+u*s;i[1]=r*n+o*s;i[2]=e*n+y*s;i[3]=a*n+c*s;i[4]=u*n-h*s;i[5]=o*n-r*s;i[6]=y*n-e*s;i[7]=c*n-a*s;return this};e.fromRotationTranslation=function(t,i){var s=this.val,n=t.x,h=t.y,r=t.z,e=t.w,a=n+n,u=h+h,o=r+r,y=n*a,c=n*u,f=n*o,x=h*u,v=h*o,l=r*o,z=e*a,d=e*u,w=e*o;s[0]=1-(x+l);s[1]=c+w;s[2]=f-d;s[3]=0;s[4]=c-w;s[5]=1-(y+l);s[6]=v+z;s[7]=0;s[8]=f+d;s[9]=v-z;s[10]=1-(y+x);s[11]=0;s[12]=i.x;s[13]=i.y;s[14]=i.z;s[15]=1;return this};e.fromQuat=function(t){var i=this.val,s=t.x,n=t.y,h=t.z,r=t.w,e=s+s,a=n+n,u=h+h,o=s*e,y=s*a,c=s*u,f=n*a,x=n*u,v=h*u,l=r*e,z=r*a,d=r*u;i[0]=1-(f+v);i[1]=y+d;i[2]=c-z;i[3]=0;i[4]=y-d;i[5]=1-(o+v);i[6]=x+l;i[7]=0;i[8]=c+z;i[9]=x-l;i[10]=1-(o+f);i[11]=0;i[12]=0;i[13]=0;i[14]=0;i[15]=1;return this};e.frustum=function(t,i,s,n,h,r){var e=this.val,a=1/(i-t),u=1/(n-s),o=1/(h-r);e[0]=h*2*a;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=h*2*u;e[6]=0;e[7]=0;e[8]=(i+t)*a;e[9]=(n+s)*u;e[10]=(r+h)*o;e[11]=-1;e[12]=0;e[13]=0;e[14]=r*h*2*o;e[15]=0;return this};e.perspective=function(t,i,s,n){var h=this.val,r=1/Math.tan(t/2),e=1/(s-n);h[0]=r/i;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=r;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=(n+s)*e;h[11]=-1;h[12]=0;h[13]=0;h[14]=2*n*s*e;h[15]=0;return this};e.ortho=function(t,i,s,n,h,r,e){var t=this.val,a=1/(i-s),u=1/(n-h),o=1/(r-e);t[0]=-2*a;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=-2*u;t[6]=0;t[7]=0;t[8]=0;t[9]=0;t[10]=2*o;t[11]=0;t[12]=(i+s)*a;t[13]=(h+n)*u;t[14]=(e+r)*o;t[15]=1;return this};e.lookAt=function(t,i,s){var n=this.val,r,e,a,u,o,y,c,f,x,v,l=t.x,z=t.y,d=t.z,w=s.x,M=s.y,p=s.z,m=i.x,q=i.y,g=i.z;if(Math.abs(l-m)<h&&Math.abs(z-q)<h&&Math.abs(d-g)<h){return this.identity()}c=l-m;f=z-q;x=d-g;v=1/Math.sqrt(c*c+f*f+x*x);c*=v;f*=v;x*=v;r=M*x-p*f;e=p*c-w*x;a=w*f-M*c;v=Math.sqrt(r*r+e*e+a*a);if(!v){r=0;e=0;a=0}else{v=1/v;r*=v;e*=v;a*=v}u=f*a-x*e;o=x*r-c*a;y=c*e-f*r;v=Math.sqrt(u*u+o*o+y*y);if(!v){u=0;o=0;y=0}else{v=1/v;u*=v;o*=v;y*=v}n[0]=r;n[1]=u;n[2]=c;n[3]=0;n[4]=e;n[5]=o;n[6]=f;n[7]=0;n[8]=a;n[9]=y;n[10]=x;n[11]=0;n[12]=-(r*l+e*z+a*d);n[13]=-(u*l+o*z+y*d);n[14]=-(c*l+f*z+x*d);n[15]=1;return this};e.mul=e.multiply;e.idt=e.identity;e.reset=e.idt;e.toString=function(){var t=this.val;return"Matrix4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"};i.exports=r},{}],3:[function(t,i,s){var n=t("./Vector3");var h=t("./Matrix3");var r=t("./common");var e=typeof Int8Array!=="undefined"?new Int8Array([1,2,0]):[1,2,0];var a=typeof Float32Array!=="undefined"?new Float32Array([0,0,0]):[0,0,0];var u=new n(1,0,0);var o=new n(0,1,0);var y=new n;var c=new h;function f(t,i,s,n){if(typeof t==="object"){this.x=t.x||0;this.y=t.y||0;this.z=t.z||0;this.w=t.w||0}else{this.x=t||0;this.y=i||0;this.z=s||0;this.w=n||0}}var x=f.prototype;for(var v in r){x[v]=r[v]}x.rotationTo=function(t,i){var s=t.x*i.x+t.y*i.y+t.z*i.z;if(s<-.999999){if(y.copy(u).cross(t).len()<1e-6)y.copy(o).cross(t);y.normalize();return this.setAxisAngle(y,Math.PI)}else if(s>.999999){this.x=0;this.y=0;this.z=0;this.w=1;return this}else{y.copy(t).cross(i);this.x=y.x;this.y=y.y;this.z=y.z;this.w=1+s;return this.normalize()}};x.setAxes=function(t,i,s){var n=c.val;n[0]=i.x;n[3]=i.y;n[6]=i.z;n[1]=uquat.x;n[4]=uquat.y;n[7]=uquat.z;n[2]=t.x;n[5]=t.y;n[8]=t.z;return this.fromMat3(c).normalize()};x.identity=function(){this.x=this.y=this.z=0;this.w=1;return this};x.setAxisAngle=function(t,i){i=i*.5;var s=Math.sin(i);this.x=s*t.x;this.y=s*t.y;this.z=s*t.z;this.w=Math.cos(i);return this};x.multiply=function(t){var i=this.x,s=this.y,n=this.z,h=this.w,r=t.x,e=t.y,a=t.z,u=t.w;this.x=i*u+h*r+s*a-n*e;this.y=s*u+h*e+n*r-i*a;this.z=n*u+h*a+i*e-s*r;this.w=h*u-i*r-s*e-n*a;return this};x.slerp=function(t,i){var s=this.x,n=this.y,h=this.y,r=this.y,e=t.x,a=t.y,u=t.z,o=t.w;var y,c,f,x,v;c=s*e+n*a+h*u+r*o;if(c<0){c=-c;e=-e;a=-a;u=-u;o=-o}if(1-c>1e-6){y=Math.acos(c);f=Math.sin(y);x=Math.sin((1-i)*y)/f;v=Math.sin(i*y)/f}else{x=1-i;v=i}this.x=x*s+v*e;this.y=x*n+v*a;this.z=x*h+v*u;this.w=x*r+v*o;return this};x.invert=function(){var t=this.x,i=this.y,s=this.z,n=this.w,h=t*t+i*i+s*s+n*n,r=h?1/h:0;this.x=-t*r;this.y=-i*r;this.z=-s*r;this.w=n*r;return this};x.conjugate=function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this};x.rotateX=function(t){t*=.5;var i=this.x,s=this.y,n=this.z,h=this.w,r=Math.sin(t),e=Math.cos(t);this.x=i*e+h*r;this.y=s*e+n*r;this.z=n*e-s*r;this.w=h*e-i*r;return this};x.rotateY=function(t){t*=.5;var i=this.x,s=this.y,n=this.z,h=this.w,r=Math.sin(t),e=Math.cos(t);this.x=i*e-n*r;this.y=s*e+h*r;this.z=n*e+i*r;this.w=h*e-s*r;return this};x.rotateZ=function(t){t*=.5;var i=this.x,s=this.y,n=this.z,h=this.w,r=Math.sin(t),e=Math.cos(t);this.x=i*e+s*r;this.y=s*e-i*r;this.z=n*e+h*r;this.w=h*e-n*r;return this};x.calculateW=function(){var t=this.x,i=this.y,s=this.z;this.x=t;this.y=i;this.z=s;this.w=-Math.sqrt(Math.abs(1-t*t-i*i-s*s));return this};x.fromMat3=function(t){var i=t.val,s=i[0]+i[4]+i[8];var n;if(s>0){n=Math.sqrt(s+1);this.w=.5*n;n=.5/n;this.x=(i[7]-i[5])*n;this.y=(i[2]-i[6])*n;this.z=(i[3]-i[1])*n}else{var h=0;if(i[4]>i[0])h=1;if(i[8]>i[h*3+h])h=2;var r=e[h];var u=e[r];n=Math.sqrt(i[h*3+h]-i[r*3+r]-i[u*3+u]+1);a[h]=.5*n;n=.5/n;a[r]=(i[r*3+h]+i[h*3+r])*n;a[u]=(i[u*3+h]+i[h*3+u])*n;this.x=a[0];this.y=a[1];this.z=a[2];this.w=(i[u*3+r]-i[r*3+u])*n}return this};x.idt=x.identity;x.sub=x.subtract;x.mul=x.multiply;x.len=x.length;x.lenSq=x.lengthSq;x.reset=x.idt;x.toString=function(){return"Quaternion("+this.x+", "+this.y+", "+this.z+", "+this.w+")"};i.exports=f},{"./Matrix3":1,"./Vector3":5,"./common":7}],4:[function(t,i,s){function n(t,i){if(typeof t==="object"){this.x=t.x||0;this.y=t.y||0}else{this.x=t||0;this.y=i||0}}var h=n.prototype;h.clone=function(){return new n(this.x,this.y)};h.copy=function(t){this.x=t.x;this.y=t.y;return this};h.set=function(t,i){this.x=t||0;this.y=i||0;return this};h.add=function(t){this.x+=t.x;this.y+=t.y;return this};h.subtract=function(t){this.x-=t.x;this.y-=t.y;return this};h.multiply=function(t){this.x*=t.x;this.y*=t.y;return this};h.scale=function(t){this.x*=t;this.y*=t;return this};h.divide=function(t){this.x/=t.x;this.y/=t.y;return this};h.negate=function(){this.x=-this.x;this.y=-this.y;return this};h.distance=function(t){var i=t.x-this.x,s=t.y-this.y;return Math.sqrt(i*i+s*s)};h.distanceSq=function(t){var i=t.x-this.x,s=t.y-this.y;return i*i+s*s};h.length=function(){var t=this.x,i=this.y;return Math.sqrt(t*t+i*i)};h.lengthSq=function(){var t=this.x,i=this.y;return t*t+i*i};h.normalize=function(){var t=this.x,i=this.y;var s=t*t+i*i;if(s>0){s=1/Math.sqrt(s);this.x=t*s;this.y=i*s}return this};h.dot=function(t){return this.x*t.x+this.y*t.y};h.cross=function(t){return this.x*t.y-this.y*t.x};h.lerp=function(t,i){var s=this.x,n=this.y;i=i||0;this.x=s+i*(t.x-s);this.y=n+i*(t.y-n);return this};h.transformMat3=function(t){var i=this.x,s=this.y,n=t.val;this.x=n[0]*i+n[2]*s+n[4];this.y=n[1]*i+n[3]*s+n[5];return this};h.transformMat4=function(t){var i=this.x,s=this.y,n=t.val;this.x=n[0]*i+n[4]*s+n[12];this.y=n[1]*i+n[5]*s+n[13];return this};h.reset=function(){this.x=0;this.y=0;return this};h.sub=h.subtract;h.mul=h.multiply;h.div=h.divide;h.dist=h.distance;h.distSq=h.distanceSq;h.len=h.length;h.lenSq=h.lengthSq;h.toString=function(){return"Vector2("+this.x+", "+this.y+")"};h.random=function(t){t=t||1;var i=Math.random()*2*Math.PI;this.x=Math.cos(i)*t;this.y=Math.sin(i)*t;return this};i.exports=n},{}],5:[function(t,i,s){function n(t,i,s){if(typeof t==="object"){this.x=t.x||0;this.y=t.y||0;this.z=t.z||0}else{this.x=t||0;this.y=i||0;this.z=s||0}}var h=n.prototype;h.clone=function(){return new n(this.x,this.y,this.z)};h.copy=function(t){this.x=t.x;this.y=t.y;this.z=t.z;return this};h.set=function(t,i,s){this.x=t||0;this.y=i||0;this.z=s||0;return this};h.add=function(t){this.x+=t.x;this.y+=t.y;this.z+=t.z;return this};h.subtract=function(t){this.x-=t.x;this.y-=t.y;this.z-=t.z;return this};h.multiply=function(t){this.x*=t.x;this.y*=t.y;this.z*=t.z;return this};h.scale=function(t){this.x*=t;this.y*=t;this.z*=t;return this};h.divide=function(t){this.x/=t.x;this.y/=t.y;this.z/=t.z;return this};h.negate=function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this};h.distance=function(t){var i=t.x-this.x,s=t.y-this.y,n=t.z-this.z;return Math.sqrt(i*i+s*s+n*n)};h.distanceSq=function(t){var i=t.x-this.x,s=t.y-this.y,n=t.z-this.z;return i*i+s*s+n*n};h.length=function(){var t=this.x,i=this.y,s=this.z;return Math.sqrt(t*t+i*i+s*s)};h.lengthSq=function(){var t=this.x,i=this.y,s=this.z;return t*t+i*i+s*s};h.normalize=function(){var t=this.x,i=this.y,s=this.z;var n=t*t+i*i+s*s;if(n>0){n=1/Math.sqrt(n);this.x=t*n;this.y=i*n;this.z=s*n}return this};h.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z};h.cross=function(t){var i=this.x,s=this.y,n=this.z,h=t.x,r=t.y,e=t.z;this.x=s*e-n*r;this.y=n*h-i*e;this.z=i*r-s*h;return this};h.lerp=function(t,i){var s=this.x,n=this.y,h=this.z;i=i||0;this.x=s+i*(t.x-s);this.y=n+i*(t.y-n);this.z=h+i*(t.z-h);return this};h.transformMat4=function(t){var i=this.x,s=this.y,n=this.z,h=t.val;this.x=h[0]*i+h[4]*s+h[8]*n+h[12];this.y=h[1]*i+h[5]*s+h[9]*n+h[13];this.z=h[2]*i+h[6]*s+h[10]*n+h[14];return this};h.transformMat3=function(t){var i=this.x,s=this.y,n=this.z,h=t.val;this.x=i*h[0]+s*h[3]+n*h[6];this.y=i*h[1]+s*h[4]+n*h[7];this.z=i*h[2]+s*h[5]+n*h[8];return this};h.transformQuat=function(t){var i=this.x,s=this.y,n=this.z,h=t.x,r=t.y,e=t.z,a=t.w,u=a*i+r*n-e*s,o=a*s+e*i-h*n,y=a*n+h*s-r*i,c=-h*i-r*s-e*n;this.x=u*a+c*-h+o*-e-y*-r;this.y=o*a+c*-r+y*-h-u*-e;this.z=y*a+c*-e+u*-r-o*-h;return this};h.prj=function(t){var i=this.x,s=this.y,n=this.z,h=t.val,r=h[0],e=h[1],a=h[2],u=h[3],o=h[4],y=h[5],c=h[6],f=h[7],x=h[8],v=h[9],l=h[10],z=h[11],d=h[12],w=h[13],M=h[14],p=h[15];var m=1/(i*u+s*f+n*z+p);this.x=(i*r+s*o+n*x+d)*m;this.y=(i*e+s*y+n*v+w)*m;this.z=(i*a+s*c+n*l+M)*m;return this};h.random=function(t){t=t||1;var i=Math.random()*2*Math.PI;var s=Math.random()*2-1;var n=Math.sqrt(1-s*s)*t;this.x=Math.cos(i)*n;this.y=Math.sin(i)*n;this.z=s*t;return this};h.reset=function(){this.x=0;this.y=0;this.z=0;return this};h.sub=h.subtract;h.mul=h.multiply;h.div=h.divide;h.dist=h.distance;h.distSq=h.distanceSq;h.len=h.length;h.lenSq=h.lengthSq;h.toString=function(){return"Vector3("+this.x+", "+this.y+", "+this.z+")"};h.str=h.toString;i.exports=n},{}],6:[function(t,i,s){var n=t("./common");function h(t,i,s,n){if(typeof t==="object"){this.x=t.x||0;this.y=t.y||0;this.z=t.z||0;this.w=t.w||0}else{this.x=t||0;this.y=i||0;this.z=s||0;this.w=n||0}}var r=h.prototype;for(var e in n){r[e]=n[e]}r.clone=function(){return new h(this.x,this.y,this.z,this.w)};r.multiply=function(t){this.x*=t.x;this.y*=t.y;this.z*=t.z;this.w*=t.w;return this};r.divide=function(t){this.x/=t.x;this.y/=t.y;this.z/=t.z;this.w/=t.w;return this};r.distance=function(t){var i=t.x-this.x,s=t.y-this.y,n=t.z-this.z,h=t.w-this.w;return Math.sqrt(i*i+s*s+n*n+h*h)};r.distanceSq=function(t){var i=t.x-this.x,s=t.y-this.y,n=t.z-this.z,h=t.w-this.w;return i*i+s*s+n*n+h*h};r.negate=function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w;return this};r.transformMat4=function(t){var i=t.val,s=this.x,n=this.y,h=this.z,r=this.w;this.x=i[0]*s+i[4]*n+i[8]*h+i[12]*r;this.y=i[1]*s+i[5]*n+i[9]*h+i[13]*r;this.z=i[2]*s+i[6]*n+i[10]*h+i[14]*r;this.w=i[3]*s+i[7]*n+i[11]*h+i[15]*r;return this};r.transformQuat=function(t){var i=this.x,s=this.y,n=this.z,h=t.x,r=t.y,e=t.z,a=t.w,u=a*i+r*n-e*s,o=a*s+e*i-h*n,y=a*n+h*s-r*i,c=-h*i-r*s-e*n;this.x=u*a+c*-h+o*-e-y*-r;this.y=o*a+c*-r+y*-h-u*-e;this.z=y*a+c*-e+u*-r-o*-h;return out};r.random=function(t){t=t||1;this.x=(Math.random()*2-1)*t;this.y=(Math.random()*2-1)*t;this.z=(Math.random()*2-1)*t;this.w=(Math.random()*2-1)*t;return this};r.reset=function(){this.x=0;this.y=0;this.z=0;this.w=0;return this};r.sub=r.subtract;r.mul=r.multiply;r.div=r.divide;r.dist=r.distance;r.distSq=r.distanceSq;r.len=r.length;r.lenSq=r.lengthSq;r.toString=function(){return"Vector4("+this.x+", "+this.y+", "+this.z+", "+this.w+")"};i.exports=h},{"./common":7}],7:[function(t,i,s){i.exports={copy:function(t){this.x=t.x;this.y=t.y;this.z=t.z;this.w=t.w;return this},set:function(t,i,s,n){this.x=t||0;this.y=i||0;this.z=s||0;this.w=n||0;return this},add:function(t){this.x+=t.x;this.y+=t.y;this.z+=t.z;this.w+=t.w;return this},subtract:function(t){this.x-=t.x;this.y-=t.y;this.z-=t.z;this.w-=t.w;return this},scale:function(t){this.x*=t;this.y*=t;this.z*=t;this.w*=t;return this},length:function(){var t=this.x,i=this.y,s=this.z,n=this.w;return Math.sqrt(t*t+i*i+s*s+n*n)},lengthSq:function(){var t=this.x,i=this.y,s=this.z,n=this.w;return t*t+i*i+s*s+n*n},normalize:function(){var t=this.x,i=this.y,s=this.z,n=this.w;var h=t*t+i*i+s*s+n*n;if(h>0){h=1/Math.sqrt(h);this.x=t*h;this.y=i*h;this.z=s*h;this.w=n*h}return this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lerp:function(t,i){var s=this.x,n=this.y,h=this.z,r=this.w;i=i||0;this.x=s+i*(t.x-s);this.y=n+i*(t.y-n);this.z=h+i*(t.z-h);this.w=r+i*(t.w-r);return this}}},{}],8:[function(t,i,s){i.exports={Vector2:t("./Vector2"),Vector3:t("./Vector3"),Vector4:t("./Vector4"),Matrix3:t("./Matrix3"),Matrix4:t("./Matrix4"),Quaternion:t("./Quaternion")}},{"./Matrix3":1,"./Matrix4":2,"./Quaternion":3,"./Vector2":4,"./Vector3":5,"./Vector4":6}]},{},[8])(8)});